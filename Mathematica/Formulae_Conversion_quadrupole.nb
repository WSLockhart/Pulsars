(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     42597,       1096]
NotebookOptionsPosition[     41682,       1060]
NotebookOutlinePosition[     42039,       1076]
CellTagsIndexPosition[     41996,       1073]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 StyleBox[
  RowBox[{"Converting", " ", "Formulae", " ", "to", " ", "C"}], 
  "Section"]], "Input",
 CellChangeTimes->{{3.745851652388587*^9, 3.745851659238553*^9}},
 FontSize->16],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{
     "Lambda", ",", "Omega", ",", " ", "OmegaZ", ",", "M", ",", "Rstar", ",", 
      "iota", ",", "mu", ",", "theta", ",", "phi", ",", "\[Theta]", ",", 
      "\[Phi]", ",", "\[Theta]prime", ",", "\[Phi]prime"}], "]"}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.746471056822101*^9, 3.74647112130726*^9}, {
  3.746474868408649*^9, 3.746474871446579*^9}, {3.746474909150434*^9, 
  3.746474909900393*^9}}],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"rotate\[Theta]", "[", "inc_", "]"}], ":=", 
    RowBox[{"ArcCos", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], 
       RowBox[{"Cos", "[", "inc", "]"}]}], "-", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]", "]"}], 
       RowBox[{"Cos", "[", "\[Phi]", "]"}], 
       RowBox[{"Sin", "[", "inc", "]"}]}]}], "]"}]}], ";"}],
  FontSize->16], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"rotate\[Phi]", "[", "inc_", "]"}], ":=", " ", 
     RowBox[{"ArcTan", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"Cos", "[", "\[Phi]", "]"}], 
          RowBox[{"Cos", "[", "inc", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]", "]"}], 
          RowBox[{"Sin", "[", "inc", "]"}]}]}], ")"}], ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]", "]"}], 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ")"}]}], "]"}]}], ";"}], 
   "   "}],
  FontSize->16], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"\[Theta]prime", " ", "=", " ", 
    RowBox[{"rotate\[Theta]", "[", "iota", "]"}]}], ";"}],
  FontSize->16], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"\[Phi]prime", "=", 
     RowBox[{"rotate\[Phi]", "[", "iota", "]"}]}], ";"}],
   FontSize->16], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"MOI", "=", 
     RowBox[{"II", "*", "M", "*", 
      SuperscriptBox["Rstar", "2"]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"OmegaZ", " ", "=", 
     RowBox[{
      FractionBox[
       RowBox[{"2", "*", "MOI"}], 
       SuperscriptBox["Rstar", "3"]], "Omega"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"f", " ", "=", " ", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"2", "M"}], "r"]}]}], ";"}],
   FontSize->16], 
  StyleBox[" ",
   FontSize->16]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R1", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"-", "3"}], 
     RowBox[{"2", "r"}]], 
    RowBox[{"(", 
     FractionBox[
      RowBox[{"3", "-", 
       RowBox[{"4", "f"}], "+", 
       SuperscriptBox["f", "2"], "+", 
       RowBox[{"2", 
        RowBox[{"Log", "[", "f", "]"}]}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", "f"}], ")"}], "3"]], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R2", " ", "=", " ", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["10", 
       RowBox[{"3", 
        SuperscriptBox["r", "2"]}]]}], 
     RowBox[{"(", 
      FractionBox[
       RowBox[{"17", "-", 
        RowBox[{"9", "f"}], "-", 
        RowBox[{"9", 
         SuperscriptBox["f", "2"]}], "+", 
        SuperscriptBox["f", "3"], "+", 
        RowBox[{"12", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"3", "f"}]}], ")"}], 
         RowBox[{
          RowBox[{"Log", "[", "f", "]"}], "/", "2"}]}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "f"}], ")"}], "5"]], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]1", " ", "=", 
   RowBox[{"Rstar", "*", 
    RowBox[{"(", 
     RowBox[{"R1", "/.", 
      RowBox[{"{", 
       RowBox[{"r", "\[Rule]", "Rstar"}], "}"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]2", " ", "=", " ", 
   RowBox[{
    SuperscriptBox["Rstar", "2"], "*", 
    RowBox[{"(", 
     RowBox[{"R2", "/.", 
      RowBox[{"{", 
       RowBox[{"r", "\[Rule]", "Rstar"}], "}"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mu2", "=", " ", 
    RowBox[{"mu", "*", "q", 
     RowBox[{"(", 
      RowBox[{"Rstar", 
       FractionBox["\[CapitalDelta]1", "\[CapitalDelta]2"]}], ")"}]}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"NB", ":", " ", "\[Alpha]quad"}], " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"B1", "*", 
         SuperscriptBox["Rstar", "3"]}], "\[CapitalDelta]1"], "R1", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Sin", "[", "\[Theta]prime", "]"}], ")"}], "2"]}], " ", "+", 
      "  ", 
      RowBox[{
       FractionBox[
        RowBox[{"B2", "*", 
         SuperscriptBox["Rstar", "4"]}], "\[CapitalDelta]2"], " ", "R2", " ", 
       
       RowBox[{"Cos", "[", "\[Theta]prime", "]"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Sin", "[", "\[Theta]prime", "]"}], ")"}], "2"], 
       "\[IndentingNewLine]", "and", " ", "mu"}]}], " ", "=", " ", 
     RowBox[{"B1", "*", 
      RowBox[{
       SuperscriptBox["Rstar", "3"], "/", "\[CapitalDelta]1"}]}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["\[Alpha]dip",
     FontSize->16], 
    StyleBox["=",
     FontSize->16], 
    RowBox[{
     StyleBox["mu",
      FontSize->16], 
     StyleBox["*",
      FontSize->16], 
     StyleBox["R1",
      FontSize->16], 
     StyleBox["*",
      FontSize->16], 
     SuperscriptBox[
      RowBox[{
       StyleBox["(",
        FontSize->16], 
       RowBox[{"Sin", "[", "\[Theta]prime", "]"}], ")"}], "2"]}]}], 
   StyleBox[";",
    FontSize->16]}], 
  StyleBox[" ",
   FontSize->16], 
  StyleBox["\[IndentingNewLine]",
   FontSize->16]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]quad", " ", "=", " ", 
    RowBox[{
     RowBox[{"mu", "*", "R1", "*", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"Sin", "[", "\[Theta]prime", "]"}], ")"}], "2"]}], " ", "+", 
     "  ", 
     RowBox[{"mu2", "*", "R2", "*", 
      RowBox[{"Cos", "[", "\[Theta]prime", "]"}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"Sin", "[", "\[Theta]prime", "]"}], ")"}], "2"]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"\[Alpha]0", "=", 
     RowBox[{
      SqrtBox[
       FractionBox["3", "2"]], "mu", "*", "Omega", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         FractionBox["1", "5"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"Sin", "[", "iota", "]"}], ")"}], "2"]}]}], ")"}]}]}], 
    ";"}],
   FontSize->16], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"\[Beta]", "=", " ", "\[Phi]prime"}], ";"}],
   FontSize->16], 
  StyleBox["  ",
   FontSize->16], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"\[Alpha]", "=", "\[Alpha]quad"}], ";"}],
   FontSize->16], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "We", " ", "have", " ", "simplified", " ", "the", " ", "formulae", " ", 
      "for", " ", "J", " ", "by", " ", "eliminating", " ", "terms", " ", 
      "with", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "r"], "\[Beta]"}], " ", "which", " ", 
      "are", " ", "zero"}], ",", " ", 
     RowBox[{"and", " ", "putting", " ", 
      RowBox[{"in", " ", "'"}], 
      RowBox[{"f", "'"}], " ", "in", " ", "place", " ", "of", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{"2", "M"}], "r"]}], ")"}]}]}], " ", "*)"}],
   FontSize->16], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"Jt", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       SqrtBox["f"], ")"}], " ", 
      FractionBox[
       RowBox[{"Omega", "-", "OmegaZ"}], 
       RowBox[{
        SuperscriptBox["r", "2"], "f"}]], 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "\[Theta]"], "\[Alpha]"}], " ", 
         RowBox[{
          SubscriptBox["\[PartialD]", "\[Theta]"], 
          RowBox[{
           SubscriptBox["\[PartialD]", "\[Phi]"], "\[Beta]"}]}]}], " ", "-", 
        " ", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "\[Theta]"], "\[Beta]"}], " ", 
         RowBox[{
          SubscriptBox["\[PartialD]", "\[Theta]"], 
          RowBox[{
           SubscriptBox["\[PartialD]", "\[Phi]"], "\[Alpha]"}]}]}], " ", "-", 
        " ", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "\[Phi]"], "\[Alpha]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            SubscriptBox["\[PartialD]", "\[Theta]"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Sin", "[", "\[Theta]", "]"}], 
              RowBox[{
               SubscriptBox["\[PartialD]", "\[Theta]"], "\[Beta]"}]}], 
             ")"}]}], 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]], ")"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "\[Phi]"], "\[Beta]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"f", 
            RowBox[{
             SubscriptBox["\[PartialD]", "r"], 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["r", "2"], 
               RowBox[{
                SubscriptBox["\[PartialD]", "r"], "\[Alpha]"}]}], ")"}]}]}], 
           "+", 
           FractionBox[
            RowBox[{
             SubscriptBox["\[PartialD]", "\[Theta]"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sin", "[", "\[Theta]", "]"}], 
               RowBox[{
                SubscriptBox["\[PartialD]", "\[Theta]"], "\[Alpha]"}]}], 
              ")"}]}], 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]]}], ")"}]}]}], ")"}]}]}], 
    ";"}],
   FontSize->16], 
  StyleBox[" ",
   FontSize->16]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"Jr", "=", " ", 
    RowBox[{
     FractionBox["Lambda", 
      RowBox[{
       SqrtBox[
        RowBox[{
         SuperscriptBox["r", "2"], "f"}]], 
       RowBox[{"(", 
        RowBox[{"r", "*", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ")"}]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "\[Theta]"], "\[Alpha]"}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "\[Phi]"], "\[Beta]"}]}], " ", "-", " ", 
       
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "\[Theta]"], "\[Beta]"}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "\[Phi]"], "\[Alpha]"}]}]}], ")"}]}]}], 
   ";"}],
  FontSize->16], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"J\[Theta]", "=", " ", 
    RowBox[{
     FractionBox["Lambda", 
      RowBox[{"r", "*", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         SubscriptBox["\[PartialD]", "r"], "\[Alpha]"}]}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "\[Phi]"], "\[Beta]"}]}], ")"}]}]}], ";"}],
  FontSize->16], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"J\[Phi]", "=", " ", 
     RowBox[{
      FractionBox["Lambda", "r"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "r"], "\[Alpha]"}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "\[Theta]"], "\[Beta]"}]}], ")"}]}]}], 
    ";"}],
   FontSize->16], 
  StyleBox["\[IndentingNewLine]",
   FontSize->16]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"surfaceJ", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Jt", ",", "Jr", ",", "J\[Theta]", ",", "J\[Phi]"}], "}"}], " ", 
    "/.", 
    RowBox[{"r", "\[Rule]", "Rstar"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.745851627848338*^9, 3.7458516750619593`*^9}, {
   3.745851776481738*^9, 3.745851806735284*^9}, {3.745851893778715*^9, 
   3.745851894450686*^9}, {3.745851939929804*^9, 3.745851949255583*^9}, {
   3.745851985072307*^9, 3.745852034173483*^9}, {3.745852080010199*^9, 
   3.745852164332244*^9}, {3.745853280275326*^9, 3.7458533393889313`*^9}, {
   3.7458546490723867`*^9, 3.745854655709304*^9}, {3.745854762822074*^9, 
   3.745854775735469*^9}, {3.745855082045681*^9, 3.745855084118084*^9}, {
   3.746302407923613*^9, 3.746302469752305*^9}, {3.746302500903823*^9, 
   3.746302523933754*^9}, {3.746302554796776*^9, 3.746302567124511*^9}, {
   3.746302618475111*^9, 3.746302653665738*^9}, {3.746302984996809*^9, 
   3.746302996208062*^9}, {3.746303036424718*^9, 3.7463030543904667`*^9}, {
   3.746303132597087*^9, 3.746303168865757*^9}, {3.7463033213103943`*^9, 
   3.746303339651767*^9}, {3.746303385918168*^9, 3.746303427450747*^9}, {
   3.746367905047285*^9, 3.7463679575327797`*^9}, {3.746369245340539*^9, 
   3.746369263146596*^9}, {3.746369339168647*^9, 3.746369356047186*^9}, {
   3.746369498599044*^9, 3.746369501498913*^9}, {3.746369543177499*^9, 
   3.746369593977113*^9}, {3.7463696696854153`*^9, 3.746369692283662*^9}, {
   3.746369906422847*^9, 3.7463700128769836`*^9}, {3.746370181956574*^9, 
   3.746370253378398*^9}, {3.746370517708433*^9, 3.746370579864779*^9}, {
   3.746370632766371*^9, 3.7463706342547092`*^9}, {3.7464711831544323`*^9, 
   3.746471187835004*^9}, {3.746471356778264*^9, 3.74647141673205*^9}, {
   3.746471468763091*^9, 3.746471468885693*^9}, {3.746471537041614*^9, 
   3.746471537294162*^9}, {3.7464718155828342`*^9, 3.746471840212206*^9}, {
   3.7464758071868143`*^9, 3.746475807362569*^9}, {3.746479060248734*^9, 
   3.7464790732918253`*^9}, {3.7464794542560787`*^9, 3.746479456717184*^9}, 
   3.7464797382680492`*^9, {3.746479897095798*^9, 3.746479897532666*^9}},
 FontSize->16],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CForm", "[", "mu2", "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Power", "\[Rule]", "pow"}], ",", 
    RowBox[{"Log", "\[Rule]", "log"}], ",", 
    RowBox[{"Rstar", "\[Rule]", "R"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.746472637618019*^9, 3.7464726827230797`*^9}}],

Cell["\<\
(9*mu*q*pow(M,2)*pow(R,-1)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 - \
2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
     pow(17 - 9*(1 - 2*M*pow(R,-1)) + 6*log(1 - 2*M*pow(R,-1))*(1 + 3*(1 - \
2*M*pow(R,-1))) - 9*pow(1 - 2*M*pow(R,-1),2) + 
       pow(1 - 2*M*pow(R,-1),3),-1))/5.\
\>", "Output",
 CellChangeTimes->{
  3.746472638235304*^9, {3.746472677836897*^9, 3.746472683098316*^9}, 
   3.746476053614314*^9, 3.746479510309724*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  StyleBox[
   RowBox[{
    RowBox[{"CForm", "[", 
     RowBox[{"Jt", "/.", 
      RowBox[{"r", "\[Rule]", "Rstar"}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]", "\[Rule]", "theta"}], ",", " ", 
      RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", " ", 
      RowBox[{"Sin", "\[Rule]", "sin"}], ",", 
      RowBox[{"Cos", "\[Rule]", "cos"}], ",", 
      RowBox[{"Log", "\[Rule]", "log"}], ",", 
      RowBox[{"Power", "\[Rule]", "pow"}], ",", 
      RowBox[{"Sqrt", "\[Rule]", "sqrt"}], ",", 
      RowBox[{"Rstar", "\[Rule]", "R"}]}], "}"}], " "}],
   FontSize->14]}]], "Input",
 CellChangeTimes->{{3.745853375257844*^9, 3.745853490699149*^9}, {
  3.74585355500786*^9, 3.745853617412924*^9}, {3.745853657235075*^9, 
  3.745853666602059*^9}, {3.7458537084023333`*^9, 3.745853738989797*^9}, {
  3.746471517055283*^9, 3.746471556667671*^9}, {3.74647185569705*^9, 
  3.7464718557937813`*^9}},
 FontSize->12],

Cell["\<\
(Omega - OmegaZ)*pow(R,-2)*pow(1 - 2*M*pow(R,-1),-0.5)*(-((cos(theta)*
           pow(pow(sin(phi),2)*pow(sin(theta),2) + pow(cos(theta)*sin(iota) + \
cos(iota)*cos(phi)*sin(theta),2),-1)*sin(phi)*
           (cos(theta)*sin(iota) + cos(iota)*cos(phi)*sin(theta)) - 
          pow(pow(sin(phi),2)*pow(sin(theta),2) + pow(cos(theta)*sin(iota) + \
cos(iota)*cos(phi)*sin(theta),2),-1)*sin(phi)*sin(theta)*
           (cos(iota)*cos(phi)*cos(theta) - sin(iota)*sin(theta)))*
        ((-3*mu*q*cos(theta)*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) \
- 4*(1 - 2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
             (1 - pow(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta),2))*sin(iota)*sin(phi))/16. + 
          (3*mu*q*cos(theta)*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) \
- 4*(1 - 2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
             pow(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta),2)*sin(iota)*sin(phi))/8. + 
          (3*mu*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 - \
2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*sin(iota)*sin(phi)*
             sin(theta)*(-(cos(phi)*cos(theta)*sin(iota)) - \
cos(iota)*sin(theta)))/8. + 
          (3*mu*cos(theta)*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) - \
4*(1 - 2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*sin(iota)*
             sin(phi)*(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta)))/8. + 
          (9*mu*q*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 - \
2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*sin(iota)*sin(phi)*
             sin(theta)*(-(cos(phi)*cos(theta)*sin(iota)) - \
cos(iota)*sin(theta))*(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta)))/8.))\\
      + ((-3*mu*q*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 - \
2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
           (1 - pow(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta),2))*(-(cos(phi)*cos(theta)*sin(iota)) - \
cos(iota)*sin(theta)))/16. + 
        (3*mu*q*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 - \
2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
           pow(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta),2)*(-(cos(phi)*cos(theta)*sin(iota)) - \
cos(iota)*sin(theta)))/8. + 
        (3*mu*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 - \
2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
           (-(cos(phi)*cos(theta)*sin(iota)) - \
cos(iota)*sin(theta))*(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta)))/8.)*
      (2*cos(iota)*cos(theta)*pow(pow(sin(phi),2)*pow(sin(theta),2) + \
pow(cos(theta)*sin(iota) + cos(iota)*cos(phi)*sin(theta),2),-1)*
         pow(sin(phi),2)*sin(theta) + cos(phi)*cos(theta)*
         pow(pow(sin(phi),2)*pow(sin(theta),2) + pow(cos(theta)*sin(iota) + \
cos(iota)*cos(phi)*sin(theta),2),-1)*
         (cos(theta)*sin(iota) + cos(iota)*cos(phi)*sin(theta)) + 
        cos(phi)*pow(pow(sin(phi),2)*pow(sin(theta),2) + \
pow(cos(theta)*sin(iota) + cos(iota)*cos(phi)*sin(theta),2),-1)*sin(theta)*
         (cos(iota)*cos(phi)*cos(theta) - sin(iota)*sin(theta)) - 
        cos(iota)*pow(pow(sin(phi),2)*pow(sin(theta),2) + \
pow(cos(theta)*sin(iota) + \
cos(iota)*cos(phi)*sin(theta),2),-2)*pow(sin(phi),2)*
         pow(sin(theta),2)*(2*cos(theta)*pow(sin(phi),2)*sin(theta) + 
           2*(cos(theta)*sin(iota) + \
cos(iota)*cos(phi)*sin(theta))*(cos(iota)*cos(phi)*cos(theta) - \
sin(iota)*sin(theta))) - 
        cos(phi)*pow(pow(sin(phi),2)*pow(sin(theta),2) + \
pow(cos(theta)*sin(iota) + cos(iota)*cos(phi)*sin(theta),2),-2)*sin(theta)*
         (cos(theta)*sin(iota) + cos(iota)*cos(phi)*sin(theta))*
         (2*cos(theta)*pow(sin(phi),2)*sin(theta) + 2*(cos(theta)*sin(iota) + \
cos(iota)*cos(phi)*sin(theta))*
            (cos(iota)*cos(phi)*cos(theta) - sin(iota)*sin(theta)))) - 
     Csc(theta)*((-3*mu*q*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) - \
4*(1 - 2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
           (1 - pow(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta),2))*sin(iota)*sin(phi)*sin(theta))/16. + 
        (3*mu*q*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 - \
2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
           pow(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta),2)*sin(iota)*sin(phi)*sin(theta))/8. + 
        (3*mu*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 - \
2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*sin(iota)*sin(phi)*
           sin(theta)*(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta)))/8.)*
      (cos(theta)*(cos(theta)*pow(pow(sin(phi),2)*pow(sin(theta),2) + \
pow(cos(theta)*sin(iota) + cos(iota)*cos(phi)*sin(theta),2),-1)*sin(phi)*
            (cos(theta)*sin(iota) + cos(iota)*cos(phi)*sin(theta)) - 
           pow(pow(sin(phi),2)*pow(sin(theta),2) + pow(cos(theta)*sin(iota) + \
cos(iota)*cos(phi)*sin(theta),2),-1)*sin(phi)*sin(theta)*
            (cos(iota)*cos(phi)*cos(theta) - sin(iota)*sin(theta))) + 
        sin(theta)*(-(pow(pow(sin(phi),2)*pow(sin(theta),2) + \
pow(cos(theta)*sin(iota) + cos(iota)*cos(phi)*sin(theta),2),-1)*sin(phi)*
              sin(theta)*(-(cos(theta)*sin(iota)) - \
cos(iota)*cos(phi)*sin(theta))) - 
           pow(pow(sin(phi),2)*pow(sin(theta),2) + pow(cos(theta)*sin(iota) + \
cos(iota)*cos(phi)*sin(theta),2),-1)*sin(phi)*sin(theta)*
            (cos(theta)*sin(iota) + cos(iota)*cos(phi)*sin(theta)) - 
           cos(theta)*pow(pow(sin(phi),2)*pow(sin(theta),2) + \
pow(cos(theta)*sin(iota) + cos(iota)*cos(phi)*sin(theta),2),-2)*sin(phi)*
            (cos(theta)*sin(iota) + cos(iota)*cos(phi)*sin(theta))*
            (2*cos(theta)*pow(sin(phi),2)*sin(theta) + \
2*(cos(theta)*sin(iota) + cos(iota)*cos(phi)*sin(theta))*
               (cos(iota)*cos(phi)*cos(theta) - sin(iota)*sin(theta))) + 
           pow(pow(sin(phi),2)*pow(sin(theta),2) + pow(cos(theta)*sin(iota) + \
cos(iota)*cos(phi)*sin(theta),2),-2)*sin(phi)*sin(theta)*
            (cos(iota)*cos(phi)*cos(theta) - sin(iota)*sin(theta))*
            (2*cos(theta)*pow(sin(phi),2)*sin(theta) + \
2*(cos(theta)*sin(iota) + cos(iota)*cos(phi)*sin(theta))*
               (cos(iota)*cos(phi)*cos(theta) - sin(iota)*sin(theta))))) + 
     (cos(iota)*pow(pow(sin(phi),2)*pow(sin(theta),2) + \
pow(cos(theta)*sin(iota) + \
cos(iota)*cos(phi)*sin(theta),2),-1)*pow(sin(phi),2)*
         pow(sin(theta),2) + cos(phi)*pow(pow(sin(phi),2)*pow(sin(theta),2) + \
pow(cos(theta)*sin(iota) + cos(iota)*cos(phi)*sin(theta),2),-1)*
         sin(theta)*(cos(theta)*sin(iota) + cos(iota)*cos(phi)*sin(theta)))*
      ((1 - 2*M*pow(R,-1))*(pow(R,2)*((-3*mu*pow(M,-3)*pow(R,2)*
                 (8*pow(M,2)*pow(R,-4) + 16*M*pow(R,-3) - 8*M*pow(R,-3)*(1 - \
2*M*pow(R,-1)) - 8*pow(M,2)*pow(R,-4)*pow(1 - 2*M*pow(R,-1),-2) - 
                   8*M*pow(R,-3)*pow(1 - 2*M*pow(R,-1),-1))*(1 - \
pow(cos(iota)*cos(theta) - cos(phi)*sin(iota)*sin(theta),2)))/16. - 
              (3*mu*R*pow(M,-3)*(-8*M*pow(R,-2) + 4*M*pow(R,-2)*(1 - \
2*M*pow(R,-1)) + 4*M*pow(R,-2)*pow(1 - 2*M*pow(R,-1),-1))*
                 (1 - pow(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta),2)))/4. - 
              (3*mu*pow(M,-3)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 - \
2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
                 (1 - pow(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta),2)))/8. - 
              (9*mu*q*pow(M,-3)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 - \
2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
                 (1 - pow(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta),2))*(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta)))/8. - 
              (3*mu*q*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 \
- 2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
                 (-72*pow(M,2)*pow(R,-4) + 36*M*pow(R,-3) - 72*M*log(1 - \
2*M*pow(R,-1))*pow(R,-3) + 24*pow(M,2)*pow(R,-4)*(1 - 2*M*pow(R,-1)) + 
                   72*M*pow(R,-3)*(1 - 2*M*pow(R,-1)) - \
24*pow(M,2)*pow(R,-4)*(1 + 3*(1 - 2*M*pow(R,-1)))*pow(1 - 2*M*pow(R,-1),-2) + \

                   144*pow(M,2)*pow(R,-4)*pow(1 - 2*M*pow(R,-1),-1) - \
24*M*pow(R,-3)*(1 + 3*(1 - 2*M*pow(R,-1)))*pow(1 - 2*M*pow(R,-1),-1) - 
                   12*M*pow(R,-3)*pow(1 - 2*M*pow(R,-1),2))*
                 pow(17 - 9*(1 - 2*M*pow(R,-1)) + 6*log(1 - 2*M*pow(R,-1))*(1 \
+ 3*(1 - 2*M*pow(R,-1))) - 9*pow(1 - 2*M*pow(R,-1),2) + 
                   pow(1 - 2*M*pow(R,-1),3),-1)*(1 - pow(cos(iota)*cos(theta) \
- cos(phi)*sin(iota)*sin(theta),2))*
                 (cos(iota)*cos(theta) - cos(phi)*sin(iota)*sin(theta)))/16. - 
              (9*mu*q*R*pow(M,-3)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 - \
2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
                 (-18*M*pow(R,-2) + 36*M*log(1 - 2*M*pow(R,-1))*pow(R,-2) - \
36*M*pow(R,-2)*(1 - 2*M*pow(R,-1)) + 
                   12*M*pow(R,-2)*(1 + 3*(1 - 2*M*pow(R,-1)))*pow(1 - \
2*M*pow(R,-1),-1) + 6*M*pow(R,-2)*pow(1 - 2*M*pow(R,-1),2))*
                 pow(17 - 9*(1 - 2*M*pow(R,-1)) + 6*log(1 - 2*M*pow(R,-1))*(1 \
+ 3*(1 - 2*M*pow(R,-1))) - 9*pow(1 - 2*M*pow(R,-1),2) + 
                   pow(1 - 2*M*pow(R,-1),3),-1)*(1 - pow(cos(iota)*cos(theta) \
- cos(phi)*sin(iota)*sin(theta),2))*
                 (cos(iota)*cos(theta) - cos(phi)*sin(iota)*sin(theta)))/8.) + 
           2*R*((-3*mu*pow(M,-3)*pow(R,2)*(-8*M*pow(R,-2) + 4*M*pow(R,-2)*(1 \
- 2*M*pow(R,-1)) + 4*M*pow(R,-2)*pow(1 - 2*M*pow(R,-1),-1))*
                 (1 - pow(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta),2)))/16. - 
              (3*mu*R*pow(M,-3)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 - \
2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
                 (1 - pow(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta),2)))/8. - 
              (9*mu*q*R*pow(M,-3)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 - \
2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
                 (1 - pow(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta),2))*(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta)))/16.\\
               - (3*mu*q*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) - \
4*(1 - 2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
                 (-18*M*pow(R,-2) + 36*M*log(1 - 2*M*pow(R,-1))*pow(R,-2) - \
36*M*pow(R,-2)*(1 - 2*M*pow(R,-1)) + 
                   12*M*pow(R,-2)*(1 + 3*(1 - 2*M*pow(R,-1)))*pow(1 - \
2*M*pow(R,-1),-1) + 6*M*pow(R,-2)*pow(1 - 2*M*pow(R,-1),2))*
                 pow(17 - 9*(1 - 2*M*pow(R,-1)) + 6*log(1 - 2*M*pow(R,-1))*(1 \
+ 3*(1 - 2*M*pow(R,-1))) - 9*pow(1 - 2*M*pow(R,-1),2) + 
                   pow(1 - 2*M*pow(R,-1),3),-1)*(1 - pow(cos(iota)*cos(theta) \
- cos(phi)*sin(iota)*sin(theta),2))*
                 (cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta)))/16.)) + 
        Csc(theta)*(cos(theta)*((-3*mu*q*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - \
2*M*pow(R,-1)) - 4*(1 - 2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
                 (1 - pow(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta),2))*(-(cos(phi)*cos(theta)*sin(iota)) - \
cos(iota)*sin(theta)))/
               16. + (3*mu*q*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) \
- 4*(1 - 2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
                 pow(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta),2)*(-(cos(phi)*cos(theta)*sin(iota)) - \
cos(iota)*sin(theta)))/8. + 
              (3*mu*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 - \
2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
                 (-(cos(phi)*cos(theta)*sin(iota)) - \
cos(iota)*sin(theta))*(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta)))/8.) + 
           sin(theta)*((3*mu*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) \
- 4*(1 - 2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
                 pow(-(cos(phi)*cos(theta)*sin(iota)) - \
cos(iota)*sin(theta),2))/8. + 
              (9*mu*q*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 \
- 2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
                 pow(-(cos(phi)*cos(theta)*sin(iota)) - \
cos(iota)*sin(theta),2)*(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta)))/8. - 
              (3*mu*q*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 \
- 2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
                 (1 - pow(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta),2))*(-(cos(iota)*cos(theta)) + \
cos(phi)*sin(iota)*sin(theta)))/
               16. + (3*mu*q*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) \
- 4*(1 - 2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
                 pow(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta),2)*(-(cos(iota)*cos(theta)) + \
cos(phi)*sin(iota)*sin(theta)))/8. + 
              (3*mu*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 - \
2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
                 (cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta))*(-(cos(iota)*cos(theta)) + \
cos(phi)*sin(iota)*sin(theta)))/8.))))\
\>", "Output",
 CellChangeTimes->{
  3.74647155710355*^9, 3.746471856264494*^9, 3.746474845398645*^9, 
   3.746474875914888*^9, 3.746474914635133*^9, {3.746475113405335*^9, 
   3.7464751323393507`*^9}, {3.7464797163322773`*^9, 3.746479757943522*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   StyleBox[
    RowBox[{"CForm", "[", 
     RowBox[{"Jr", "/.", 
      RowBox[{"r", "\[Rule]", "Rstar"}]}], "]"}],
    FontSize->14], 
   StyleBox["/.",
    FontSize->14], 
   RowBox[{
    StyleBox["{",
     FontSize->16], 
    RowBox[{
     StyleBox[
      RowBox[{"\[Theta]", "\[Rule]", "theta"}],
      FontSize->16], 
     StyleBox[",",
      FontSize->16], 
     StyleBox[" ",
      FontSize->16], 
     RowBox[{
      StyleBox["\[Phi]",
       FontSize->16], 
      StyleBox["\[Rule]",
       FontSize->16], 
      StyleBox["phi",
       FontSize->14]}], 
     StyleBox[",",
      FontSize->14], 
     StyleBox[" ",
      FontSize->14], 
     StyleBox[
      RowBox[{"Sin", "\[Rule]", "sin"}],
      FontSize->14], 
     StyleBox[",",
      FontSize->14], 
     StyleBox[
      RowBox[{"Cos", "\[Rule]", "cos"}],
      FontSize->14], 
     StyleBox[",",
      FontSize->14], 
     StyleBox[
      RowBox[{"Log", "\[Rule]", "log"}],
      FontSize->14], 
     StyleBox[",",
      FontSize->14], 
     StyleBox[
      RowBox[{"Power", "\[Rule]", "pow"}],
      FontSize->14], 
     StyleBox[",",
      FontSize->14], 
     StyleBox[
      RowBox[{"Sqrt", "\[Rule]", "sqrt"}],
      FontSize->14], 
     StyleBox[",",
      FontSize->14], 
     RowBox[{
      StyleBox[
       RowBox[{
        StyleBox["R",
         FontSize->14], 
        StyleBox["star",
         FontSize->14]}]], 
      StyleBox["\[Rule]",
       FontSize->14], 
      StyleBox["R",
       FontSize->14]}]}], 
    StyleBox["}",
     FontSize->14]}]}], 
  StyleBox[" ",
   FontSize->14], 
  StyleBox["\[IndentingNewLine]",
   FontSize->14]}]], "Input",
 CellChangeTimes->{{3.745853747533597*^9, 3.745853748781522*^9}, {
  3.745855188393508*^9, 3.7458551906060038`*^9}, {3.7464716434169607`*^9, 
  3.746471660020067*^9}, {3.746474824520369*^9, 3.746474834282933*^9}, {
  3.74647711362014*^9, 3.7464771177288313`*^9}, {3.746478580889052*^9, 
  3.746478582894024*^9}, {3.746478638067049*^9, 3.746478641235289*^9}, {
  3.746479825010042*^9, 3.746479825088418*^9}},
 FontSize->12],

Cell["\<\
Lambda*Csc(theta)*pow(R,-1)*pow((1 - 2*M*pow(R,-1))*pow(R,2),-0.5)*
   (-((cos(theta)*pow(pow(sin(phi),2)*pow(sin(theta),2) + \
pow(cos(theta)*sin(iota) + cos(iota)*cos(phi)*sin(theta),2),-1)*sin(phi)*
           (cos(theta)*sin(iota) + cos(iota)*cos(phi)*sin(theta)) - 
          pow(pow(sin(phi),2)*pow(sin(theta),2) + pow(cos(theta)*sin(iota) + \
cos(iota)*cos(phi)*sin(theta),2),-1)*sin(phi)*sin(theta)*
           (cos(iota)*cos(phi)*cos(theta) - sin(iota)*sin(theta)))*
        ((-3*mu*q*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 - \
2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
             (1 - pow(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta),2))*sin(iota)*sin(phi)*sin(theta))/16. + 
          (3*mu*q*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 - \
2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
             pow(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta),2)*sin(iota)*sin(phi)*sin(theta))/8. + 
          (3*mu*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 - \
2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*sin(iota)*sin(phi)*
             sin(theta)*(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta)))/8.)) + 
     (cos(iota)*pow(pow(sin(phi),2)*pow(sin(theta),2) + \
pow(cos(theta)*sin(iota) + \
cos(iota)*cos(phi)*sin(theta),2),-1)*pow(sin(phi),2)*
         pow(sin(theta),2) + cos(phi)*pow(pow(sin(phi),2)*pow(sin(theta),2) + \
pow(cos(theta)*sin(iota) + cos(iota)*cos(phi)*sin(theta),2),-1)*
         sin(theta)*(cos(theta)*sin(iota) + cos(iota)*cos(phi)*sin(theta)))*
      ((-3*mu*q*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 - \
2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
           (1 - pow(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta),2))*(-(cos(phi)*cos(theta)*sin(iota)) - \
cos(iota)*sin(theta)))/16. + 
        (3*mu*q*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 - \
2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
           pow(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta),2)*(-(cos(phi)*cos(theta)*sin(iota)) - \
cos(iota)*sin(theta)))/8. + 
        (3*mu*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 - \
2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
           (-(cos(phi)*cos(theta)*sin(iota)) - \
cos(iota)*sin(theta))*(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta)))/8.))\
\>", "Output",
 CellChangeTimes->{
  3.74585375002094*^9, 3.7458546156501617`*^9, 3.745854780584919*^9, 
   3.745855093013143*^9, 3.7463679993057623`*^9, 3.746471233117517*^9, 
   3.7464718605514727`*^9, 3.746474835238253*^9, 3.746474881570262*^9, 
   3.7464749178897133`*^9, 3.746477119509159*^9, {3.746478233199347*^9, 
   3.746478264864717*^9}, 3.74647858383924*^9, {3.746478622417008*^9, 
   3.746478641673752*^9}, 3.7464797896994057`*^9, 3.7464798254424458`*^9},
 FontSize->12]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"CForm", "[", 
    RowBox[{"J\[Theta]", 
     StyleBox[
      RowBox[{"/", "."}]], 
     RowBox[{"r", "->", "Rstar"}]}], "]"}],
   FontSize->14], 
  StyleBox["/.",
   FontSize->14], 
  RowBox[{
   StyleBox["{",
    FontSize->16], 
   StyleBox[
    RowBox[{
     StyleBox[
      RowBox[{"\[Theta]", "\[Rule]", "theta"}],
      FontSize->16], 
     StyleBox[",",
      FontSize->16], 
     StyleBox[" ",
      FontSize->16], 
     RowBox[{
      StyleBox["\[Phi]",
       FontSize->16], 
      StyleBox["\[Rule]",
       FontSize->16], "phi"}], ",", " ", 
     RowBox[{"Sin", "\[Rule]", "sin"}], ",", 
     RowBox[{"Cos", "\[Rule]", "cos"}], ",", 
     RowBox[{"Log", "\[Rule]", "log"}], ",", 
     RowBox[{"Power", "\[Rule]", "pow"}], ",", 
     RowBox[{"Sqrt", "\[Rule]", "sqrt"}], ",", 
     RowBox[{
      StyleBox[
       RowBox[{
        StyleBox["R",
         FontSize->14], "star"}]], "\[Rule]", "R"}]}],
    FontSize->14], 
   StyleBox["}",
    FontSize->14]}], 
  StyleBox[" ",
   FontSize->14]}]], "Input",
 CellChangeTimes->{{3.7458537541669416`*^9, 3.745853763349593*^9}, {
  3.746471784913321*^9, 3.746471786503223*^9}, {3.7464749503007927`*^9, 
  3.746474957817789*^9}, {3.7464766863779783`*^9, 3.746476688008494*^9}},
 FontSize->12],

Cell["\<\
Lambda*Csc(theta)*pow(R,-1)*(cos(iota)*pow(pow(sin(phi),2)*pow(sin(theta),2) \
+ pow(cos(theta)*sin(iota) + cos(iota)*cos(phi)*sin(theta),2),-1)*
      pow(sin(phi),2)*pow(sin(theta),2) + \
cos(phi)*pow(pow(sin(phi),2)*pow(sin(theta),2) + 
        pow(cos(theta)*sin(iota) + \
cos(iota)*cos(phi)*sin(theta),2),-1)*sin(theta)*(cos(theta)*sin(iota) + \
cos(iota)*cos(phi)*sin(theta)))*
   ((3*mu*pow(M,-3)*pow(R,2)*(-8*M*pow(R,-2) + 4*M*pow(R,-2)*(1 - \
2*M*pow(R,-1)) + 4*M*pow(R,-2)*pow(1 - 2*M*pow(R,-1),-1))*
        (1 - pow(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta),2)))/16. + 
     (3*mu*R*pow(M,-3)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 - 2*M*pow(R,-1)) \
+ pow(1 - 2*M*pow(R,-1),2))*
        (1 - pow(cos(iota)*cos(theta) - cos(phi)*sin(iota)*sin(theta),2)))/8. \
+ 
     (9*mu*q*R*pow(M,-3)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 - \
2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
        (1 - pow(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta),2))*(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta)))/16. + 
     (3*mu*q*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 - \
2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
        (-18*M*pow(R,-2) + 144*M*log(1 - 2*M*pow(R,-1))*pow(R,-2) - \
36*M*pow(R,-2)*(1 - 2*M*pow(R,-1)) + 
          48*M*pow(R,-2)*(1 + 3*(1 - 2*M*pow(R,-1)))*pow(1 - \
2*M*pow(R,-1),-1) + 6*M*pow(R,-2)*pow(1 - 2*M*pow(R,-1),2))*
        pow(17 - 9*(1 - 2*M*pow(R,-1)) + 24*log(1 - 2*M*pow(R,-1))*(1 + 3*(1 \
- 2*M*pow(R,-1))) - 9*pow(1 - 2*M*pow(R,-1),2) + 
          pow(1 - 2*M*pow(R,-1),3),-1)*(1 - pow(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta),2))*
        (cos(iota)*cos(theta) - cos(phi)*sin(iota)*sin(theta)))/16.)\
\>", "Output",
 CellChangeTimes->{
  3.745853764818712*^9, 3.745854618838181*^9, 3.7458547839588747`*^9, 
   3.745855096111897*^9, 3.746368001258733*^9, 3.746471237898075*^9, 
   3.746471864270307*^9, 3.7464749590008907`*^9, {3.7464766833301983`*^9, 
   3.746476711158598*^9}},
 FontSize->12]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   StyleBox["CForm",
    FontSize->14], 
   StyleBox["[",
    FontSize->14], 
   RowBox[{
    StyleBox["J\[Phi]",
     FontSize->14], 
    StyleBox[
     StyleBox[
      RowBox[{"/", "."}]],
     FontSize->14], 
    RowBox[{
     StyleBox["r",
      FontSize->14], 
     StyleBox["\[Rule]",
      FontSize->14], "Rstar"}]}], 
   StyleBox["]",
    FontSize->14]}], 
  StyleBox["/.",
   FontSize->14], 
  RowBox[{
   StyleBox["{",
    FontSize->16], 
   StyleBox[
    RowBox[{
     StyleBox[
      RowBox[{"\[Theta]", "\[Rule]", "theta"}],
      FontSize->16], 
     StyleBox[",",
      FontSize->16], 
     StyleBox[" ",
      FontSize->16], 
     RowBox[{
      StyleBox["\[Phi]",
       FontSize->16], 
      StyleBox["\[Rule]",
       FontSize->16], "phi"}], ",", " ", 
     RowBox[{"Sin", "\[Rule]", "sin"}], ",", 
     RowBox[{"Cos", "\[Rule]", "cos"}], ",", 
     RowBox[{"Log", "\[Rule]", "log"}], ",", 
     RowBox[{"Power", "\[Rule]", "pow"}], ",", 
     RowBox[{"Sqrt", "\[Rule]", "sqrt"}], ",", 
     RowBox[{
      StyleBox[
       RowBox[{
        StyleBox["R",
         FontSize->14], "star"}]], "\[Rule]", "R"}]}],
    FontSize->14], 
   StyleBox["}",
    FontSize->14]}], 
  StyleBox[" ",
   FontSize->14]}]], "Input",
 CellChangeTimes->{{3.745853768932601*^9, 3.745853770405015*^9}, {
  3.746471790821848*^9, 3.74647179152654*^9}, {3.7464749752439423`*^9, 
  3.746474979361532*^9}},
 FontSize->12],

Cell["\<\
Lambda*pow(R,-1)*(cos(theta)*pow(pow(sin(phi),2)*pow(sin(theta),2) + \
pow(cos(theta)*sin(iota) + cos(iota)*cos(phi)*sin(theta),2),-1)*sin(phi)*
      (cos(theta)*sin(iota) + cos(iota)*cos(phi)*sin(theta)) - 
     pow(pow(sin(phi),2)*pow(sin(theta),2) + pow(cos(theta)*sin(iota) + \
cos(iota)*cos(phi)*sin(theta),2),-1)*sin(phi)*sin(theta)*
      (cos(iota)*cos(phi)*cos(theta) - sin(iota)*sin(theta)))*
   ((-3*mu*pow(M,-3)*pow(R,2)*(-8*M*pow(R,-2) + 4*M*pow(R,-2)*(1 - \
2*M*pow(R,-1)) + 4*M*pow(R,-2)*pow(1 - 2*M*pow(R,-1),-1))*
        (1 - pow(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta),2)))/16. - 
     (3*mu*R*pow(M,-3)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 - 2*M*pow(R,-1)) \
+ pow(1 - 2*M*pow(R,-1),2))*
        (1 - pow(cos(iota)*cos(theta) - cos(phi)*sin(iota)*sin(theta),2)))/8. \
- 
     (9*mu*q*R*pow(M,-3)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 - \
2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
        (1 - pow(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta),2))*(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta)))/16. - 
     (3*mu*q*pow(M,-3)*pow(R,2)*(3 + 2*log(1 - 2*M*pow(R,-1)) - 4*(1 - \
2*M*pow(R,-1)) + pow(1 - 2*M*pow(R,-1),2))*
        (-18*M*pow(R,-2) + 36*M*log(1 - 2*M*pow(R,-1))*pow(R,-2) - \
36*M*pow(R,-2)*(1 - 2*M*pow(R,-1)) + 
          12*M*pow(R,-2)*(1 + 3*(1 - 2*M*pow(R,-1)))*pow(1 - \
2*M*pow(R,-1),-1) + 6*M*pow(R,-2)*pow(1 - 2*M*pow(R,-1),2))*
        pow(17 - 9*(1 - 2*M*pow(R,-1)) + 6*log(1 - 2*M*pow(R,-1))*(1 + 3*(1 - \
2*M*pow(R,-1))) - 9*pow(1 - 2*M*pow(R,-1),2) + 
          pow(1 - 2*M*pow(R,-1),3),-1)*(1 - pow(cos(iota)*cos(theta) - \
cos(phi)*sin(iota)*sin(theta),2))*
        (cos(iota)*cos(theta) - cos(phi)*sin(iota)*sin(theta)))/16.)\
\>", "Output",
 CellChangeTimes->{3.7458537710675983`*^9, 3.74585462068917*^9, 
  3.7458547858820267`*^9, 3.745855098876074*^9, 3.746368003189784*^9, 
  3.746471244436355*^9, 3.746471865841731*^9, 3.7464749798146544`*^9, 
  3.7464798066243887`*^9},
 FontSize->12]
}, Open  ]]
},
WindowSize->{1241, 968},
WindowMargins->{{Automatic, -1920}, {Automatic, 0}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 28, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 194, 5, 49, "Input"],
Cell[755, 27, 541, 12, 75, "Input"],
Cell[1299, 41, 13794, 414, 1297, "Input"],
Cell[CellGroupData[{
Cell[15118, 459, 316, 8, 32, "Input"],
Cell[15437, 469, 441, 9, 79, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15915, 483, 977, 23, 51, "Input"],
Cell[16895, 508, 13030, 221, 2005, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29962, 734, 2085, 80, 55, "Input"],
Cell[32050, 816, 2815, 49, 365, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34902, 870, 1293, 46, 35, "Input"],
Cell[36198, 918, 1995, 38, 280, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38230, 961, 1448, 58, 35, "Input"],
Cell[39681, 1021, 1985, 36, 297, "Output"]
}, Open  ]]
}
]
*)

